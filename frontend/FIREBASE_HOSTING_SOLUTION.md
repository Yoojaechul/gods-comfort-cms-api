# Firebase Hosting API ìš”ì²­ ë¶„ë¦¬ ì „ëµ

## í˜„ì¬ ìƒí™© ë¶„ì„

### firebase.json í˜„ì¬ ì„¤ì •
```json
{
  "hosting": {
    "site": "gods-comfort-word-cms",
    "public": "dist",
    "rewrites": [
      { "source": "**", "destination": "/index.html" }
    ]
  }
}
```

**ë¬¸ì œì :**
- `"source": "**"` ê·œì¹™ì´ ëª¨ë“  ê²½ë¡œë¥¼ `index.html`ë¡œ rewrite
- `/creator/videos`, `/auth/login` ê°™ì€ API ê²½ë¡œë„ HTMLë¡œ ë°˜í™˜ë¨
- í•˜ì§€ë§Œ **í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œëŠ” ì´ë¯¸ ë³„ë„ API ì„œë²„ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •ë¨**

---

## âœ… ê¶Œì¥ í•´ê²°ì±…: ë³„ë„ ë„ë©”ì¸ ì‚¬ìš© (í˜„ì¬ êµ¬ì¡° ìœ ì§€)

### ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  cms.godcomfortword.com             â”‚
â”‚  (Firebase Hosting - SPAë§Œ ì œê³µ)    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ React SPA (Vite build)       â”‚  â”‚
â”‚  â”‚ - /login                     â”‚  â”‚
â”‚  â”‚ - /admin/*                   â”‚  â”‚
â”‚  â”‚ - /creator/*                 â”‚  â”‚
â”‚  â”‚ - /change-password           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                          â”‚
â”‚           â”‚ API í˜¸ì¶œ                 â”‚
â”‚           â”‚ (ì ˆëŒ€ URL)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ HTTPS
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  api.godcomfortword.com             â”‚
â”‚  (ë³„ë„ API ì„œë²„)                    â”‚
â”‚  - /auth/login                      â”‚
â”‚  - /auth/change-password            â”‚
â”‚  - /creator/videos                  â”‚
â”‚  - /admin/videos                    â”‚
â”‚  - /videos                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### firebase.json ì„¤ì • (ë³€ê²½ ë¶ˆí•„ìš”)

```json
{
  "hosting": {
    "site": "gods-comfort-word-cms",
    "public": "dist",
    "ignore": ["firebase.json", "**/.*", "**/node_modules/**"],
    "rewrites": [
      {
        "source": "**",
        "destination": "/index.html"
      }
    ],
    "headers": [
      {
        "source": "**/*.@(js|css|woff|woff2|ttf|eot)",
        "headers": [
          {
            "key": "Cache-Control",
            "value": "public, max-age=31536000, immutable"
          }
        ]
      },
      {
        "source": "/index.html",
        "headers": [
          {
            "key": "Cache-Control",
            "value": "no-cache, no-store, must-revalidate"
          }
        ]
      }
    ]
  }
}
```

**ì„¤ëª…:**
- ëª¨ë“  ê²½ë¡œë¥¼ `index.html`ë¡œ rewrite (SPA ë¼ìš°íŒ…)
- API ìš”ì²­ì€ í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œì—ì„œ ì ˆëŒ€ URLë¡œ ë³„ë„ ë„ë©”ì¸ìœ¼ë¡œ ì „ì†¡
- Firebase Hostingì€ SPAë§Œ ì œê³µ

### í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •

**`.env.production` íŒŒì¼:**
```env
VITE_API_BASE_URL=https://api.godcomfortword.com
```

**í”„ë¡œë•ì…˜ ë¹Œë“œ:**
```bash
VITE_API_BASE_URL=https://api.godcomfortword.com npm run build
firebase deploy --only hosting
```

**ê²°ê³¼:**
- SPA ë¼ìš°íŒ…: `https://cms.godcomfortword.com/creator/my-videos` â†’ `index.html`
- API ìš”ì²­: `https://api.godcomfortword.com/creator/videos` â†’ API ì„œë²„

---

## ğŸ”§ ìµœì†Œ ìˆ˜ì •ì•ˆ (ê°™ì€ ë„ë©”ì¸ ì‚¬ìš© ì‹œ - ë¹„ê¶Œì¥)

### âš ï¸ ì£¼ì˜: Firebase Hostingë§Œìœ¼ë¡œëŠ” API ì œê³µ ë¶ˆê°€ëŠ¥

Firebase Hostingì€ **ì •ì  íŒŒì¼ë§Œ ì œê³µ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. APIë¥¼ ì œê³µí•˜ë ¤ë©´ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ê°€ í•„ìš”í•©ë‹ˆë‹¤:

1. Firebase Functions (ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜)
2. Firebase Cloud Run (ì»¨í…Œì´ë„ˆ)
3. ë³„ë„ API ì„œë²„

### ë°©ë²• 1: API ê²½ë¡œë¥¼ 404ë¡œ ì²˜ë¦¬ (ì‹¤ìš©ì ì´ì§€ ì•ŠìŒ)

```json
{
  "hosting": {
    "site": "gods-comfort-word-cms",
    "public": "dist",
    "rewrites": [
      {
        "source": "/auth/**",
        "type": 404
      },
      {
        "source": "/creator/**",
        "type": 404
      },
      {
        "source": "/admin/**",
        "type": 404
      },
      {
        "source": "/videos/**",
        "type": 404
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  }
}
```

**ë¬¸ì œì :**
- API ê²½ë¡œê°€ 404ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ ì‚¬ìš© ë¶ˆê°€
- ì‹¤ì œë¡œëŠ” API ì„œë²„ê°€ ë³„ë„ë¡œ í•„ìš”
- ì˜ë¯¸ ì—†ìŒ

### ë°©ë²• 2: Firebase Functionsë¡œ API í”„ë¡ì‹œ (ë³µì¡í•¨)

```json
{
  "hosting": {
    "site": "gods-comfort-word-cms",
    "public": "dist",
    "rewrites": [
      {
        "source": "/api/**",
        "function": "apiProxy"
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  },
  "functions": {
    "source": "functions",
    "runtime": "nodejs18"
  }
}
```

**í•„ìš”í•œ ì‘ì—…:**
1. Firebase Functions í”„ë¡œì íŠ¸ ì„¤ì •
2. API í”„ë¡ì‹œ í•¨ìˆ˜ ì‘ì„±
3. í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ìˆ˜ì • (API ê²½ë¡œë¥¼ `/api/*`ë¡œ ë³€ê²½)
4. Firebase Functions ë°°í¬

**ë‹¨ì :**
- ë³µì¡ë„ ì¦ê°€
- ì½œë“œ ìŠ¤íƒ€íŠ¸ ì§€ì—° ê°€ëŠ¥
- ë¹„ìš© ì¦ê°€
- ì„±ëŠ¥ ì €í•˜

---

## ğŸ“‹ ê¶Œì¥ vs ë¹„ê¶Œì¥ ë¹„êµ

| ë°©ë²• | ë³µì¡ë„ | ì„±ëŠ¥ | ë¹„ìš© | í™•ì¥ì„± | ê¶Œì¥ë„ |
|------|--------|------|------|--------|--------|
| **ë³„ë„ ë„ë©”ì¸** | â­ ë‚®ìŒ | â­â­â­ ìš°ìˆ˜ | â­â­â­ ë‚®ìŒ | â­â­â­ ìš°ìˆ˜ | âœ… **ê¶Œì¥** |
| Firebase Functions í”„ë¡ì‹œ | â­â­â­ ë†’ìŒ | â­â­ ë³´í†µ | â­â­ ë³´í†µ | â­â­ ë³´í†µ | âŒ ë¹„ê¶Œì¥ |
| API ê²½ë¡œ 404 ì²˜ë¦¬ | â­ ë‚®ìŒ | - | - | - | âŒ ì˜ë¯¸ ì—†ìŒ |

---

## ğŸ¯ ìµœì¢… ê¶Œì¥ ì‚¬í•­

### âœ… ê¶Œì¥: í˜„ì¬ êµ¬ì¡° ìœ ì§€ + í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**ì´ìœ :**
1. **ë‹¨ìˆœí•¨**: firebase.json ìˆ˜ì • ë¶ˆí•„ìš”
2. **ëª…í™•í•œ ë¶„ë¦¬**: SPAì™€ APIê°€ ì™„ì „íˆ ë¶„ë¦¬ë¨
3. **í™•ì¥ì„±**: API ì„œë²„ ë…ë¦½ì  ìŠ¤ì¼€ì¼ë§ ê°€ëŠ¥
4. **ì„±ëŠ¥**: ì§ì ‘ API ì„œë²„ ì—°ê²°, í”„ë¡ì‹œ ì˜¤ë²„í—¤ë“œ ì—†ìŒ
5. **ë¹„ìš©**: Firebase Functions ë¹„ìš© ì—†ìŒ

**í•„ìš”í•œ ì‘ì—…:**
1. `.env.production` íŒŒì¼ì— ì˜¬ë°”ë¥¸ API ì„œë²„ ì£¼ì†Œ ì„¤ì •
2. í”„ë¡œë•ì…˜ ë¹Œë“œ ì‹œ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
3. Firebase ë°°í¬ (firebase.json ë³€ê²½ ë¶ˆí•„ìš”)

### âŒ ë¹„ê¶Œì¥: ê°™ì€ ë„ë©”ì¸ì—ì„œ API ì œê³µ

**ì´ìœ :**
1. Firebase Hostingì€ ì •ì  íŒŒì¼ë§Œ ì œê³µ ê°€ëŠ¥
2. API ì œê³µì„ ìœ„í•´ Firebase Functions/Cloud Run í•„ìš”
3. ë³µì¡ë„, ë¹„ìš©, ì„±ëŠ¥ ì €í•˜ ë°œìƒ
4. ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì•„í‚¤í…ì²˜

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í˜„ì¬ ìƒíƒœ í™•ì¸
- [x] firebase.jsonì— SPA rewrite ê·œì¹™ ì¡´ì¬
- [x] í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œê°€ ë³„ë„ API ì„œë²„ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •ë¨
- [ ] `.env.production`ì— ì˜¬ë°”ë¥¸ API ì„œë²„ ì£¼ì†Œ ì„¤ì • í•„ìš”

### í”„ë¡œë•ì…˜ ë°°í¬ ì „ í™•ì¸
- [ ] `.env.production` íŒŒì¼ì— `VITE_API_BASE_URL=https://api.godcomfortword.com` ì„¤ì •
- [ ] ë¹Œë“œ í›„ Network íƒ­ì—ì„œ ì‹¤ì œ API ìš”ì²­ URL í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- [ ] API ì„œë²„ê°€ ì‹¤ì œë¡œ `api.godcomfortword.com`ì—ì„œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸

---

## ê²°ë¡ 

**firebase.jsonì€ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ê³ , í”„ë¡ íŠ¸ì—”ë“œ í™˜ê²½ ë³€ìˆ˜ë§Œ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ìµœì„ ì˜ ë°©ë²•ì…ë‹ˆë‹¤.**

Firebase Hostingì€ SPAë§Œ ì œê³µí•˜ê³ , APIëŠ” ë³„ë„ ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” êµ¬ì¡°ê°€ ê°€ì¥ ë‹¨ìˆœí•˜ê³  íš¨ìœ¨ì ì…ë‹ˆë‹¤.













